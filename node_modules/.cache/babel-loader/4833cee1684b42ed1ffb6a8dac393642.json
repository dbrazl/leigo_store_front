{"ast":null,"code":"import produce from \"immer\";\nimport _ from \"lodash\";\nconst INITIAL_STATE = {\n  products: [],\n  total: 0\n};\nexport default function cart(state = INITIAL_STATE, action) {\n  return produce(state, draft => {\n    switch (action.type) {\n      case \"@cart/ADD_TO_CART\":\n        let oneAdd = state.products.find(item => item.id === action.payload.item.id);\n\n        add: {\n          if (!!oneAdd && oneAdd.stock < oneAdd.amount + 1) break add;\n\n          if (!!oneAdd) {\n            oneAdd.amount++;\n\n            const unionAdd = _.unionBy([oneAdd], state.products, \"id\");\n\n            draft.products = _.orderBy(unionAdd, [\"name\"], [\"asc\"]);\n            draft.total += action.payload.item.price;\n            break add;\n          }\n\n          let toAdd = action.payload.item;\n          toAdd.amount = 1;\n\n          const unionAdd = _.unionBy([toAdd], state.products, \"id\");\n\n          draft.products = _.orderBy(unionAdd, [\"name\"], [\"asc\"]);\n          draft.total += action.payload.item.price;\n        }\n\n        break;\n\n      case \"@cart/REMOVE_ONE_FROM_CART\":\n        let oneRemove = state.products.find(item => item.id === action.payload.item.id);\n\n        if (!!oneRemove && oneRemove.amount > 0) {\n          oneRemove.amount--;\n          if (oneRemove.amount === 0) draft.products = _.differenceBy(state.products, [oneRemove], \"id\");else {\n            const unionRemoveOne = _.unionBy([oneRemove], state.products, \"id\");\n\n            draft.products = _.orderBy(unionRemoveOne, [\"name\"], [\"asc\"]);\n          }\n        } else {\n          draft.products = _.differenceBy(state.products, [action.payload.item], \"id\");\n        }\n\n        if (state.total > 0) draft.total -= action.payload.item.price;\n        break;\n\n      case \"@cart/REMOVE_FROM_CART\":\n        const one = state.products.find(item => item.id === action.payload.item.id);\n\n        if (!!one) {\n          draft.products = _.differenceBy(state.products, [action.payload.item], \"id\");\n          draft.total -= one.price * one.amount;\n        }\n\n        break;\n\n      default:\n    }\n  });\n}","map":{"version":3,"sources":["/home/daniel/Documents/Projetos/Software/Web/Reactjs/leigo_store/src/store/modules/cart/reducer.js"],"names":["produce","_","INITIAL_STATE","products","total","cart","state","action","draft","type","oneAdd","find","item","id","payload","add","stock","amount","unionAdd","unionBy","orderBy","price","toAdd","oneRemove","differenceBy","unionRemoveOne","one"],"mappings":"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","sourcesContent":["import produce from \"immer\";\nimport _ from \"lodash\";\n\nconst INITIAL_STATE = {\n  products: [],\n  total: 0,\n};\n\nexport default function cart(state = INITIAL_STATE, action) {\n  return produce(state, (draft) => {\n    switch (action.type) {\n      case \"@cart/ADD_TO_CART\":\n        let oneAdd = state.products.find(\n          (item) => item.id === action.payload.item.id\n        );\n\n        add: {\n          if (!!oneAdd && oneAdd.stock < oneAdd.amount + 1) break add;\n\n          if (!!oneAdd) {\n            oneAdd.amount++;\n            const unionAdd = _.unionBy([oneAdd], state.products, \"id\");\n            draft.products = _.orderBy(unionAdd, [\"name\"], [\"asc\"]);\n            draft.total += action.payload.item.price;\n            break add;\n          }\n\n          let toAdd = action.payload.item;\n          toAdd.amount = 1;\n\n          const unionAdd = _.unionBy([toAdd], state.products, \"id\");\n          draft.products = _.orderBy(unionAdd, [\"name\"], [\"asc\"]);\n          draft.total += action.payload.item.price;\n        }\n        break;\n\n      case \"@cart/REMOVE_ONE_FROM_CART\":\n        let oneRemove = state.products.find(\n          (item) => item.id === action.payload.item.id\n        );\n\n        if (!!oneRemove && oneRemove.amount > 0) {\n          oneRemove.amount--;\n\n          if (oneRemove.amount === 0)\n            draft.products = _.differenceBy(state.products, [oneRemove], \"id\");\n          else {\n            const unionRemoveOne = _.unionBy([oneRemove], state.products, \"id\");\n            draft.products = _.orderBy(unionRemoveOne, [\"name\"], [\"asc\"]);\n          }\n        } else {\n          draft.products = _.differenceBy(\n            state.products,\n            [action.payload.item],\n            \"id\"\n          );\n        }\n\n        if (state.total > 0) draft.total -= action.payload.item.price;\n        break;\n\n      case \"@cart/REMOVE_FROM_CART\":\n        const one = state.products.find(\n          (item) => item.id === action.payload.item.id\n        );\n\n        if (!!one) {\n          draft.products = _.differenceBy(\n            state.products,\n            [action.payload.item],\n            \"id\"\n          );\n          draft.total -= one.price * one.amount;\n        }\n\n        break;\n      default:\n    }\n  });\n}\n"]},"metadata":{},"sourceType":"module"}