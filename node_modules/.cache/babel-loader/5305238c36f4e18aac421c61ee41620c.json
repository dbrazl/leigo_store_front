{"ast":null,"code":"import { takeLatest, all, put, call, race } from \"redux-saga/effects\";\nimport api from \"../../../services/api\";\nimport { signInSuccess, signFailure, signUpSuccess, restoreAccountSuccess } from \"./actions\";\nimport errorHandler from \"../utils/errorHandler\";\nimport timer from \"../utils/timer\";\n\nfunction* signIn({\n  payload\n}) {\n  try {\n    const body = payload.body;\n\n    const _ref = yield race({\n      response: call(api.post, \"/session\", body),\n      timeout: call(timer)\n    }),\n          response = _ref.response;\n\n    api.defaults.headers.Authorization = \"Bearer \".concat(token);\n    yield put(signInSuccess(response.data));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nfunction* signUp({\n  payload\n}) {\n  try {\n    const body = payload.body;\n\n    const _ref2 = yield race({\n      response: call(api.post, \"/user\", body),\n      timeout: call(timer)\n    }),\n          response = _ref2.response;\n\n    yield put(signUpSuccess(response.body));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nfunction* restoreAccount({\n  payload\n}) {\n  try {\n    const username = payload.params.username;\n\n    const _ref3 = yield race({\n      response: call(api.put, \"/restore/\".concat(username)),\n      timeout: call(timer)\n    }),\n          response = _ref3.response;\n\n    yield put(restoreAccountSuccess(response.data));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nexport default all([takeLatest(\"@auth/SIGN_IN_REQUEST\", signIn), takeLatest(\"@auth/SIGN_UP_REQUEST\", signUp), takeLatest(\"@auth/RESTORE_ACCOUNT_SUCCESS\", restoreAccount)]);","map":{"version":3,"sources":["/home/daniel/Documents/Projetos/Software/Web/Reactjs/leigo_store/src/store/modules/auth/saga.js"],"names":["takeLatest","all","put","call","race","api","signInSuccess","signFailure","signUpSuccess","restoreAccountSuccess","errorHandler","timer","signIn","payload","body","response","post","timeout","defaults","headers","Authorization","token","data","error","signUp","restoreAccount","username","params"],"mappings":"AAAA,SAASA,UAAT,EAAqBC,GAArB,EAA0BC,GAA1B,EAA+BC,IAA/B,EAAqCC,IAArC,QAAiD,oBAAjD;AACA,OAAOC,GAAP,MAAgB,uBAAhB;AAEA,SACEC,aADF,EAEEC,WAFF,EAGEC,aAHF,EAIEC,qBAJF,QAKO,WALP;AAOA,OAAOC,YAAP,MAAyB,uBAAzB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;;AAEA,UAAUC,MAAV,CAAiB;AAAEC,EAAAA;AAAF,CAAjB,EAA8B;AAC5B,MAAI;AAAA,UACMC,IADN,GACeD,OADf,CACMC,IADN;;AAAA,iBAGmB,MAAMV,IAAI,CAAC;AAC9BW,MAAAA,QAAQ,EAAEZ,IAAI,CAACE,GAAG,CAACW,IAAL,EAAW,UAAX,EAAuBF,IAAvB,CADgB;AAE9BG,MAAAA,OAAO,EAAEd,IAAI,CAACQ,KAAD;AAFiB,KAAD,CAH7B;AAAA,UAGMI,QAHN,QAGMA,QAHN;;AAQFV,IAAAA,GAAG,CAACa,QAAJ,CAAaC,OAAb,CAAqBC,aAArB,oBAA+CC,KAA/C;AAEA,UAAMnB,GAAG,CAACI,aAAa,CAACS,QAAQ,CAACO,IAAV,CAAd,CAAT;AACD,GAXD,CAWE,OAAOC,KAAP,EAAc;AACd,UAAMb,YAAY,CAACa,KAAD,EAAQhB,WAAR,CAAlB;AACD;AACF;;AAED,UAAUiB,MAAV,CAAiB;AAAEX,EAAAA;AAAF,CAAjB,EAA8B;AAC5B,MAAI;AAAA,UACMC,IADN,GACeD,OADf,CACMC,IADN;;AAAA,kBAGmB,MAAMV,IAAI,CAAC;AAC9BW,MAAAA,QAAQ,EAAEZ,IAAI,CAACE,GAAG,CAACW,IAAL,EAAW,OAAX,EAAoBF,IAApB,CADgB;AAE9BG,MAAAA,OAAO,EAAEd,IAAI,CAACQ,KAAD;AAFiB,KAAD,CAH7B;AAAA,UAGMI,QAHN,SAGMA,QAHN;;AAQF,UAAMb,GAAG,CAACM,aAAa,CAACO,QAAQ,CAACD,IAAV,CAAd,CAAT;AACD,GATD,CASE,OAAOS,KAAP,EAAc;AACd,UAAMb,YAAY,CAACa,KAAD,EAAQhB,WAAR,CAAlB;AACD;AACF;;AAED,UAAUkB,cAAV,CAAyB;AAAEZ,EAAAA;AAAF,CAAzB,EAAsC;AACpC,MAAI;AAAA,UACMa,QADN,GACmBb,OAAO,CAACc,MAD3B,CACMD,QADN;;AAAA,kBAGmB,MAAMtB,IAAI,CAAC;AAC9BW,MAAAA,QAAQ,EAAEZ,IAAI,CAACE,GAAG,CAACH,GAAL,qBAAsBwB,QAAtB,EADgB;AAE9BT,MAAAA,OAAO,EAAEd,IAAI,CAACQ,KAAD;AAFiB,KAAD,CAH7B;AAAA,UAGMI,QAHN,SAGMA,QAHN;;AAQF,UAAMb,GAAG,CAACO,qBAAqB,CAACM,QAAQ,CAACO,IAAV,CAAtB,CAAT;AACD,GATD,CASE,OAAOC,KAAP,EAAc;AACd,UAAMb,YAAY,CAACa,KAAD,EAAQhB,WAAR,CAAlB;AACD;AACF;;AAED,eAAeN,GAAG,CAAC,CACjBD,UAAU,CAAC,uBAAD,EAA0BY,MAA1B,CADO,EAEjBZ,UAAU,CAAC,uBAAD,EAA0BwB,MAA1B,CAFO,EAGjBxB,UAAU,CAAC,+BAAD,EAAkCyB,cAAlC,CAHO,CAAD,CAAlB","sourcesContent":["import { takeLatest, all, put, call, race } from \"redux-saga/effects\";\nimport api from \"../../../services/api\";\n\nimport {\n  signInSuccess,\n  signFailure,\n  signUpSuccess,\n  restoreAccountSuccess,\n} from \"./actions\";\n\nimport errorHandler from \"../utils/errorHandler\";\nimport timer from \"../utils/timer\";\n\nfunction* signIn({ payload }) {\n  try {\n    const { body } = payload;\n\n    const { response } = yield race({\n      response: call(api.post, \"/session\", body),\n      timeout: call(timer),\n    });\n\n    api.defaults.headers.Authorization = `Bearer ${token}`;\n\n    yield put(signInSuccess(response.data));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nfunction* signUp({ payload }) {\n  try {\n    const { body } = payload;\n\n    const { response } = yield race({\n      response: call(api.post, \"/user\", body),\n      timeout: call(timer),\n    });\n\n    yield put(signUpSuccess(response.body));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nfunction* restoreAccount({ payload }) {\n  try {\n    const { username } = payload.params;\n\n    const { response } = yield race({\n      response: call(api.put, `/restore/${username}`),\n      timeout: call(timer),\n    });\n\n    yield put(restoreAccountSuccess(response.data));\n  } catch (error) {\n    yield errorHandler(error, signFailure);\n  }\n}\n\nexport default all([\n  takeLatest(\"@auth/SIGN_IN_REQUEST\", signIn),\n  takeLatest(\"@auth/SIGN_UP_REQUEST\", signUp),\n  takeLatest(\"@auth/RESTORE_ACCOUNT_SUCCESS\", restoreAccount),\n]);\n"]},"metadata":{},"sourceType":"module"}